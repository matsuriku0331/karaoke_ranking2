{% extends "base.html" %}
{% block title %}{{ username }}ã®3ä½æ›² | æ ¹æ€§ã‚«ãƒ©ã‚ªã‚­ãƒ©ãƒ³ã‚­ãƒ³ã‚°{% endblock %}

{% block head %}
  <style>
    .table-wrap{overflow-x:auto}
    .col-date{min-width: 140px;}
    @media (max-width:720px){ .col-date{min-width: 160px;} }
    .score{ font-weight:900; letter-spacing:.2px; text-shadow:0 0 12px rgba(34,197,94,.18); }

    /* ãƒ¢ãƒã‚¤ãƒ«ã®ä½™ç™½ï¼†ãƒ•ã‚©ãƒ³ãƒˆæœ€é©åŒ– */
    @media (max-width:768px){
      th, td { font-size:14px; padding:8px 10px; }
    }
    @media (max-width:480px){
      th, td { font-size:13px; padding:7px 8px; }
    }
  </style>
{% endblock %}

{% block content %}
  <div class="h1" style="display:flex; align-items:center; justify-content:space-between;">
    <span>{{ username }} ã® 3ä½æ›²ãƒ©ãƒ³ã‚­ãƒ³ã‚°</span>
    <div class="row" style="gap:8px">
      <a class="btn secondary" href="{{ url_for('user_history', username=username) }}" style="font-size:14px; padding:6px 12px;">å±¥æ­´ã¸</a>
      <a class="btn secondary" href="{{ url_for('ranking') }}" style="font-size:14px; padding:6px 12px;">æ›²åˆ¥ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã¸</a>
    </div>
  </div>

  {% if ranking_cards %}
    {% for item in ranking_cards %}
      <div class="song card">
        <div class="song-head">
          <div>
            <div class="song-title">{{ item.song }}</div>
            {% if item.singer %}
              <div class="artist">æ­Œæ‰‹åï¼š<span class="chip">{{ item.singer }}</span></div>
            {% endif %}
          </div>
          <div class="muted" style="font-size:12px">Top 3</div>
        </div>

        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th style="width:60px">é †ä½</th>
                <th style="min-width:140px">ãƒ¦ãƒ¼ã‚¶ãƒ¼</th>
                <th style="min-width:100px">ã‚¹ã‚³ã‚¢</th>
                <th class="col-date">æ—¥ä»˜</th>
              </tr>
            </thead>
            <tbody>
              {% for record in item.records %}
                <tr>
                  <td class="rank">
                    {% if loop.index == 1 %}<span class="medal-1">ğŸ¥‡ 1ä½</span>
                    {% elif loop.index == 2 %}<span class="medal-2">ğŸ¥ˆ 2ä½</span>
                    {% else %}<span class="medal-3">ğŸ¥‰ 3ä½</span>{% endif %}
                  </td>
                  <td>{{ record["ãƒ¦ãƒ¼ã‚¶ãƒ¼"] }}</td>
                  <td><span class="score">{{ '%.3f'|format(record["ã‚¹ã‚³ã‚¢"]) }}</span></td>
                  <td>{{ record["æ—¥ä»˜"]|fmtdate }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    {% endfor %}
  {% else %}
    <div class="card">
      <div class="muted">3ä½ã®æ›²ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚</div>
    </div>
  {% endif %}
{% endblock %}
